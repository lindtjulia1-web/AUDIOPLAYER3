<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–≤–æ–π –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä v8.3</title>
    <style>
        :root { --accent: #00d4ff; --bg: #0f0f12; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 340px; background: #18181c; padding: 25px; border-right: 1px solid #333; overflow-y: auto; box-sizing: border-box; }
        .sidebar h2 { color: var(--accent); font-size: 14px; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; }
        label { display: block; font-size: 10px; color: #888; margin-top: 15px; font-weight: bold; text-transform: uppercase; }
        input, textarea { width: 100%; background: #26262e; border: 1px solid #3e3e42; color: #fff; padding: 10px; border-radius: 8px; margin-top: 5px; box-sizing: border-box; outline: none; }
        input:focus { border-color: var(--accent); }
        .row { display: flex; gap: 10px; }
        .btn-upd { background: var(--accent); color: #000; border: none; padding: 14px; width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 20px; transition: 0.3s; }
        .btn-upd:hover { opacity: 0.9; transform: translateY(-2px); }
        .preview-area { flex: 1; display: flex; align-items: center; justify-content: center; background: #000; position: relative; }
        #ifr-wrap { border-radius: 30px; overflow: hidden; box-shadow: 0 40px 80px rgba(0,0,0,0.8); background: #111; transition: 0.3s; }
        #mod { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .mod-cnt { background: #1a1a1e; padding: 30px; border-radius: 20px; width: 550px; border: 1px solid var(--accent); text-align: center; }
        #res { width: 100%; height: 200px; background: #000; color: #0f9; font-family: monospace; font-size: 11px; padding: 10px; border: 1px solid #333; resize: none; margin: 15px 0; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>–¢–≤–æ–π –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä</h2>
    
    <label>–ê–¥—Ä–µ—Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (–ø—Ä–µ—Ñ–∏–∫—Å)</label>
    <input type="text" id="in-gh" value="https://lindtjulia1-web.github.io/AUDIOPLAYER2/">
    
    <label>–§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ (URL)</label>
    <input type="text" id="in-bg-img" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–æ—Ç–æ">

    <label>–¶–≤–µ—Ç–∞ (–§–æ–Ω –∫–æ—Ä–ø—É—Å–∞ | –í–æ–ª–Ω–∞ | –ê–∫—Ü–µ–Ω—Ç)</label>
    <div class="row">
        <input type="color" id="in-c1" value="#161b22">
        <input type="color" id="in-c2" value="#ffffff">
        <input type="color" id="in-c3" value="#00d4ff">
    </div>

    <label>–†–∞–∑–º–µ—Ä—ã (–®–∏—Ä–∏–Ω–∞ —Ö –í—ã—Å–æ—Ç–∞)</label>
    <div class="row">
        <input type="number" id="in-w" value="600">
        <input type="number" id="in-h" value="240">
    </div>

    <label>–ü–ª–µ–π–ª–∏—Å—Ç (–ù–∞–∑–≤–∞–Ω–∏–µ | –§–∞–π–ª –∏–ª–∏ URL)</label>
    <textarea id="in-list" rows="6">Track 01 | 1.mp3
Track 02 | 2.mp3
Google Drive Song | https://drive.google.com/uc?export=download&id=–í–ê–®_ID</textarea>

    <button class="btn-upd" onclick="upd()">–û–ë–ù–û–í–ò–¢–¨ –ü–†–ï–î–ü–†–û–°–ú–û–¢–†</button>
    <button class="btn-upd" style="background:#333; color:#aaa;" onclick="show()">–°–ö–û–ü–ò–†–û–í–ê–¢–¨ –ö–û–î</button>
</div>

<div class="preview-area">
    <div id="ifr-wrap"><iframe id="ifr" frameborder="0" style="width:100%; height:100%;"></iframe></div>
</div>

<div id="mod">
    <div class="mod-cnt">
        <h3 style="margin:0; color:var(--accent)">–ì–æ—Ç–æ–≤–æ! –ö–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ Genially:</h3>
        <textarea id="res" readonly onclick="this.select()"></textarea>
        <button class="btn-upd" onclick="document.getElementById('mod').style.display='none'">–í–ï–†–ù–£–¢–¨–°–Ø</button>
    </div>
</div>

<script>
function generatePlayerHTML() {
    const gh = document.getElementById('in-gh').value;
    const bgImg = document.getElementById('in-bg-img').value;
    const c1 = document.getElementById('in-c1').value;
    const c2 = document.getElementById('in-c2').value;
    const c3 = document.getElementById('in-c3').value;
    const listRaw = document.getElementById('in-list').value.split('\n').filter(l => l.includes('|'));
    const list = listRaw.map(l => {
        const p = l.split('|');
        return { n: p[0].trim(), f: p[1].trim() };
    });

    const bgImageStyle = bgImg ? `url('${bgImg}') center/cover no-repeat` : 'none';

    return `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>
    body { margin:0; padding:0; height:100vh; font-family:sans-serif; background-color:${c1}; background-image:${bgImageStyle}; color:white; overflow:hidden; display:flex; border-radius:30px; position:relative; }
    .glass { position:absolute; inset:0; background:rgba(0,0,0,0.25); backdrop-filter:blur(${bgImg ? '12px' : '0px'}); z-index:0; }
    .vol-box { width:65px; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px; z-index:2; border-right:1px solid rgba(255,255,255,0.1); background:rgba(0,0,0,0.15); }
    .vs { writing-mode:bt-lr; -webkit-appearance:slider-vertical; height:110px; width:6px; accent-color:${c3}; cursor:pointer; }
    .main { flex:1; display:flex; flex-direction:column; padding:25px; z-index:2; position:relative; }
    .info { text-align:right; margin-bottom:5px; }
    #tn { font-size:16px; font-weight:bold; color:${c3}; text-shadow:0 2px 10px rgba(0,0,0,0.4); }
    #tm { font-size:12px; opacity:0.7; font-family:monospace; }
    .wv { flex:1; display:flex; align-items:center; justify-content:center; gap:4px; }
    .b { width:4px; height:8px; background:${c2}; border-radius:2px; box-shadow:0 0 8px ${c2}66; opacity:0.8; transition: height 0.15s ease; }
    .ctrl { display:flex; align-items:center; justify-content:flex-end; gap:18px; }
    .btn { background:none; border:none; color:white; cursor:pointer; font-size:24px; transition:0.2s; }
    .btn:hover { transform:scale(1.1); color:${c3}; }
    .pl { width:52px; height:52px; background:${c3}; color:black; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:22px; box-shadow:0 4px 15px rgba(0,0,0,0.3); }
    
    #plist { position:absolute; inset:10px; background:rgba(0,0,0,0.92); border-radius:20px; z-index:10; display:none; flex-direction:column; padding:18px; backdrop-filter:blur(15px); border:1px solid ${c3}33; }
    .pl-head { display:flex; justify-content:space-between; margin-bottom:12px; font-size:12px; color:${c3}; font-weight:bold; text-transform:uppercase; letter-spacing:1px; }
    .pl-list { flex:1; overflow-y:auto; }
    .pl-item { padding:12px; font-size:13px; cursor:pointer; border-radius:8px; margin-bottom:5px; border:1px solid transparent; transition:0.2s; }
    .pl-item:hover { background:rgba(255,255,255,0.08); }
    .pl-item.active { border-color:${c3}; color:${c3}; background:${c3}15; font-weight:bold; }
    ::-webkit-scrollbar { width:4px; } ::-webkit-scrollbar-thumb { background:${c3}66; border-radius:10px; }
    </style></head><body><div class="glass"></div>
    <div id="plist">
        <div class="pl-head"><span>–í—ã–±–æ—Ä —Ç—Ä–µ–∫–∞</span><span style="cursor:pointer; font-size:20px;" onclick="togglePL()">‚úï</span></div>
        <div class="pl-list" id="pl-content"></div>
    </div>
    <div class="vol-box">üîä<input type="range" class="vs" min="0" max="1" step="0.01" value="0.5" oninput="a.volume=this.value">üéµ</div>
    <div class="main">
        <div class="info"><div id="tn">–ó–ê–ì–†–£–ó–ö–ê...</div><div id="tm">00:00</div></div>
        <div class="wv" id="wv"></div>
        <div class="ctrl">
            <button class="btn" title="–ü–ª–µ–π–ª–∏—Å—Ç" onclick="togglePL()">üìú</button>
            <button class="btn" onclick="m(-1)">‚èÆ</button>
            <button class="btn pl" id="pb" onclick="t()">‚ñ∂</button>
            <button class="btn" onclick="m(1)">‚è≠</button>
        </div>
    </div>
    <script>
    const R="${gh}", L=${JSON.stringify(list)}; let ci=0, ip=false; const a=new Audio();
    const wv=document.getElementById('wv'); for(let i=0;i<32;i++) wv.innerHTML+='<div class="b"></div>';
    
    function buildPL(){
        document.getElementById('pl-content').innerHTML = L.map((t, i) => \`<div class="pl-item \${i===ci?'active':''}" onclick="selectT(\${i})">\${t.n}</div>\`).join('');
    }
    function togglePL(){ const p=document.getElementById('plist'); p.style.display = p.style.display==='flex'?'none':'flex'; buildPL(); }
    function selectT(i){ ld(i); togglePL(); a.play(); ip=true; pb.innerText="‚è∏"; }
    
    function ld(i){ 
        ci=i; 
        const path = L[ci].f;
        a.src = path.startsWith('http') ? path : R + path;
        document.getElementById('tn').innerText = L[ci].n; 
        buildPL(); 
    }
    
    function t(){ if(ip){a.pause(); pb.innerText="‚ñ∂"} else {a.play(); pb.innerText="‚è∏"} ip=!ip; }
    function m(s){ ci=(ci+s+L.length)%L.length; ld(ci); if(ip) a.play(); }
    
    a.ontimeupdate=()=>{
        let m=Math.floor(a.currentTime/60), s=Math.floor(a.currentTime%60);
        document.getElementById('tm').innerText=m+":"+(s<10?"0":"")+s;
        if(ip) document.querySelectorAll('.b').forEach(x=>x.style.height=(Math.random()*55+5)+'px');
    };
    a.onended=()=>m(1); ld(0);
    <\/script></body></html>`;
}

function upd() {
    const w = document.getElementById('in-w').value, h = document.getElementById('in-h').value;
    const ifr = document.getElementById('ifr');
    document.getElementById('ifr-wrap').style.width = w + "px";
    document.getElementById('ifr-wrap').style.height = h + "px";
    const blob = new Blob([generatePlayerHTML()], {type: 'text/html'});
    ifr.src = URL.createObjectURL(blob);
}

function show() {
    const rawHtml = generatePlayerHTML();
    const escapedHtml = rawHtml.replace(/"/g, '&quot;').replace(/'/g, '&apos;');
    document.getElementById('res').value = `<iframe width="${document.getElementById('in-w').value}" height="${document.getElementById('in-h').value}" srcdoc="${escapedHtml}" frameborder="0" scrolling="no" style="border-radius:30px; border:none;"></iframe>`;
    document.getElementById('mod').style.display = 'flex';
}
window.onload = upd;
</script>
</body>
</html>
